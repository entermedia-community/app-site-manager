<div id="goalresultsdiv">
#set( $allprojects = $mediaarchive.getSearcher("collectiveproject").query().match("parentcollectionid",$librarycol.getId()).sort("name").search($context) )
#set( $projectid = $context.getRequestParameter("projectid"))


#if( $projects.isEmpty() )
	[[Create a new Topic to get started]]
#end

#if( $caneditcollection)
<div class="goals-header-actions">
 	<a class="btn btn-success emdialog" 
 	title="[[New Ticket]]" 
 	data-width="900"
 	style="margin-left: 10px;"
 	href="$apphome/collective/goals/editgoalpanel.html?collectionid=$librarycol.getId()&categoryid=$!selectedcat.getId()&goalfolder=search" ><i class="fas fa-plus"></i> [[Create Ticket]]</a>
	 #if( $goalhits )
	 <a class="btn-toolbar float-right" 
	 	title="[[Export Results]]" 
	 	data-width="900"
	 	style="margin-left: 10px;"
	 	href="$apphome/collective/goals/search/export/projectgoals.csv?hitssessionid=$goalhits.getSessionId()" ><i class="fas fa-download"></i> [[Report]]</a>
	#end
<div class="clearfix"></div>
</div>
#end

#set( $col = 0)
<div class="goals-columns">

#foreach( $projectid in $projectids )

#set( $project = $mediaarchive.getData("collectiveproject",$projectid))
<div class="goals-column-container" style="width:33%" data-col="$project.id">

<div class="goals-column">
<div class="goals-column-header"> 
#set( $hits = $context.getPageValue("goalhits${projectid}"))

#if(!$project) $projectid missing #end
	$!project.name	( $!hits.size() ) 
	
</div>

<ul class="projectgoals ui-sortable"
data-oemaxlevel="2"  data-collectionid="$librarycol.getId()" data-categoryid="$!selectedcat.id" 
	data-savepath="$apphome/collective/goals/goalmovepriority.html">
#if( $hits )
	#foreach( $goal in $hits )  
		$context.putPageValue("goal",$goal)
		$pages.include("$apphome/collective/goals/search/goalrow.html",$context)
	#end
#end
</ul>

</div>
</div>
#end
</div>

#if( $toomanygoals)
 <div class="alert alert-primary" style="float:left;" role="alert">
  [[Ticket limit reached. Please close older tickets.]]
</div>
#end


</div>